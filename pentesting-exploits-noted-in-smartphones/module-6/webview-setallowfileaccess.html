<html>
<head>
    <style>
    body {
        background-color: #FFE7F5;
    }
    textarea {
        background-color: #FFE7F5;
    }
    input {
        background-color: #FFE7F5;
    }
    code {
        font-family: Consolas,"courier new";
        color: #5E155E;
        background-color: #FFA7E4;
        padding: 2px;
        font-size: 105%;
        font-weight: bold;
    }
</style>
    <script>
        window.onerror = function(msg, url, linenumber) {
            var yaymessageyay = "Error message: " + msg + "\n\nLine number: " + linenumber;
            document.getElementById("javaErrors").innerHTML = yaymessageyay;
            return true;
        }
    </script>
</head>
<body>

<h3>Example - WebView File Access and Cross-Origin</h3>
<h2>This site is used with the Pentesting Exploits Noted In Smartphones training course.</h2>
<h2>If you reached this site via Axolotl, then you've successfully reached out to the external website.</h2>
<p id="documentlocationcheck"></p>
<script>
    var locationHref = location.href;
    var locationOrigin = location.origin;
    var locationProtocol = location.protocol;
    document.getElementById("documentlocationcheck").innerHTML = "" +
        "<code>location.href</code>: " + locationHref + "<br>" +
        "<code>location.origin</code>: " + locationOrigin + "<br>" +
        "<code>location.protocol</code>: " + locationProtocol
    ;
</script>
<p id="fileAccessCheck"></p>
<script>
    var fileCheckResult = window.yayjsinterfaceyay.checkFileAccess();
    document.getElementById("fileAccessCheck").innerHTML = fileCheckResult;
</script>
Type your JavaScript into the text box below, and tap <code>eval</code>.
<br>
<br>
This will execute your input as JavaScript.
<br>
<br>
Note that <code>alert()</code> does not work in this WebView because this WebView does not use <code>setWebChromeClient()</code>.
<br>
<br>
Analyze this activity and learn about WebView File Access and CORS rules to exfiltrate files.
<br>
<textarea rows="10" cols="40" type=text id="evalInput"></textarea><br><button id="evalButton">eval</button>
<br>
<br>
<script>
var yayEvalButtonYay = document.querySelector("#evalButton");
var yayEvalInputYay = document.querySelector("#evalInput");
yayEvalButtonYay.addEventListener('click', function() {
    eval(yayEvalInputYay.value);
});
</script>
<br>
If you see the image below, then the image <code>_axolotl_phone_1.jpg</code> was loaded via a <code>file://</code> scheme (not Assets or Res folders).
<br>
<img id="axolotl1" src="file:///data/data/com.maliciouserection.axolotl/files/_axolotl_phone_1.jpg" width="369">
<br>
<br>
If you see the image below, then the image <code>_axolotl_phone_2.jpg</code> was loaded via a <code>content://</code> scheme.
<br>
<img id="axolotl2" src="content://com.maliciouserection.axolotl.provider.FileProvider/yayrootyay/files/_axolotl_phone_2.jpg" width="369">