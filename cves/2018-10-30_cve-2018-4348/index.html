<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>macOS Login Screen DoS | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="macOS Login Screen DoS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Some versions of macOS had a DoS issue on their login screen." />
<meta property="og:description" content="Some versions of macOS had a DoS issue on their login screen." />
<link rel="canonical" href="https://maliciouserection.com/cves/2018-10-30_cve-2018-4348/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2018-10-30_cve-2018-4348/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-30T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="macOS Login Screen DoS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2018-10-30T00:00:00+00:00","datePublished":"2018-10-30T00:00:00+00:00","description":"Some versions of macOS had a DoS issue on their login screen.","headline":"macOS Login Screen DoS","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2018-10-30_cve-2018-4348/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2018-10-30_cve-2018-4348/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">macOS Login Screen DoS</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriesmacos-user-interface-denial-of-service">Original post: <a href="https://labs.f-secure.com/advisories/macos-user-interface-denial-of-service/">https://labs.f-secure.com/advisories/macos-user-interface-denial-of-service/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>macOS 10.13.6, 10.13.5, 10.12.6 Security Update 2018-004, previous versions may be affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Low</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2018-4348</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Denail of Sevice</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>Various versions of macOS are vulnerable to a Denial of Service attack via the login user interface. A malicious application or an attacker with authenticated command line access to the device can deny the user’s ability to login after the user logs out or reboots the computer.</p>

<h2 id="details">Details</h2>

<p>macOS stores information about local users in the folder <code class="language-plaintext highlighter-rouge">/var/db/dslocal/nodes/Default/users/</code>. Each user is assigned a .plist file which contains configuration details about the specific user. For example, if a user <code class="language-plaintext highlighter-rouge">MWRUser</code> were to exist, then the .plist file <code class="language-plaintext highlighter-rouge">/var/db/dslocal/nodes/Default/users/MWRUser.plist</code> exists as well.</p>

<p>Plist files can contain various types of data, including strings and binary data. The data is provided by several <code class="language-plaintext highlighter-rouge">keys</code> within a .plist configuration file. Two of these keys are <code class="language-plaintext highlighter-rouge">JPEGPhoto</code> and <code class="language-plaintext highlighter-rouge">Picture</code>, which manage the user’s profile picture.</p>

<p>It was found that if the <code class="language-plaintext highlighter-rouge">JPEGphoto</code> key did not contain binary data, then the macOS operating system would crash while trying to render a profile picture for the user. This would cause the operating system to fail to load the macOS login screen, thus denying the user the ability to log into the computer via the user interface.</p>

<h2 id="impact">Impact</h2>

<p>Users of the targeted macOS system would not be able to log into their computer via the user interface.</p>

<h2 id="proof-of-concept">Proof of Concept</h2>

<p>The following terminal commands could be ran by any user or application to replicate this issue. It should be noted that low level users can only modify specific data about their own user account:</p>

<p>After logging out or restarting the macOS operating system, the user would be unable to log into the macOS operating system.</p>

<p>MWR created the following Swift code that could be used by any application to replicate this issue:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import Foundation

@discardableResult
func shell(_ args: String...) -&gt; Int32 {
    let task = Process()
    task.launchPath = "/usr/bin/env"
    task.arguments = args
    task.launch()
    task.waitUntilExit()
    return task.terminationStatus
}

var username = NSUserName()
var dscl_user = "/Users/" + username
 
shell("/usr/bin/dscl", ".", "delete", dscl_user, "JPEGPhoto")
shell("/usr/bin/dscl", ".", "append", dscl_user, "JPEGPhoto", "mwrinfosecurity")
</code></pre></div></div>

<h2 id="solution">Solution</h2>

<p>Apple has released the following updates which are not vulnerable to this issue:</p>

<ul>
  <li>macOS Mojave 10.14</li>
  <li>macOS High Sierra 10.13.6 Security Update 2018-001</li>
  <li>macOS Sierra 10.12.6 Security Update 2018-005</li>
</ul>

<p>Users should update their computers so that they are immune to this attack.</p>

<p>Alternatively, if this attack were to be used on a vulnerable macOS computer, a user can boot their computer into recovery mode, open a terminal window and run the following command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ /usr/libexec/Plistbuddy –c “Delete jpegphoto” /Volumes/&lt;mounted macOS system&gt;/var/db/dslocal/nodes/Default/users/&lt;username&gt;.plist
</code></pre></div></div>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
