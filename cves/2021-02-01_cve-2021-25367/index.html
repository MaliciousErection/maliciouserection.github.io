<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Notes Path Traversal | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Notes Path Traversal" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Path Traversal vulnerability in Samsung Notes prior to version 4.2.00.22 allows attackers to access local files without permission." />
<meta property="og:description" content="Path Traversal vulnerability in Samsung Notes prior to version 4.2.00.22 allows attackers to access local files without permission." />
<link rel="canonical" href="https://maliciouserection.com/cves/2021-02-01_cve-2021-25367/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2021-02-01_cve-2021-25367/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Notes Path Traversal" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-02-01T00:00:00+00:00","datePublished":"2021-02-01T00:00:00+00:00","description":"Path Traversal vulnerability in Samsung Notes prior to version 4.2.00.22 allows attackers to access local files without permission.","headline":"Samsung Notes Path Traversal","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2021-02-01_cve-2021-25367/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2021-02-01_cve-2021-25367/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Notes Path Traversal</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriessamsung-s20-access-external-storage-files">Original post: <a href="https://labs.f-secure.com/advisories/samsung-s20-access-external-storage-files/">https://labs.f-secure.com/advisories/samsung-s20-access-external-storage-files/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Samsung phones with Samsung Notes (prior to version )</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Low</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2021-25367</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Storage Security Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung S20 device for Tokyo Pwn2Own 2020. An issue was discovered that would have allowed a rogue application to access any file on the external storage partition without the “External Storage” Android permissions.</p>

<h2 id="technical-details">Technical Details</h2>

<p>Samsung Notes (<code class="language-plaintext highlighter-rouge">com.samsung.android.app.notes</code>) has an exported content provider called <code class="language-plaintext highlighter-rouge">clipdatacontentprovider</code> that can be used by other applications to download files from the external storage. The issue is due to the class <code class="language-plaintext highlighter-rouge">com.samsung.android.support.senl.nt.base.framework.provider.ClipDataContentProvider</code> having two methods <code class="language-plaintext highlighter-rouge">onCreate</code> and <code class="language-plaintext highlighter-rouge">addRoot</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean onCreate() {
    Context context = getContext();
    addRoot("external_files", new File(Environment.getExternalStorageDirectory(), "."));
    File[] externalFilesDirs = ContextCompat.getExternalFilesDirs(context, null);
    if (externalFilesDirs.length &lt;= 0) {
        return true;
    }
    addRoot("external-files-path", new File(externalFilesDirs[0], ShareCacheHelper.CACHE_PATH));
    return true;
}
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void addRoot(String str, File file) {
    if (!TextUtils.isEmpty(str)) {
        try {
            mRoots.put(str, file.getCanonicalFile());
        } catch (IOException e) {
            throw new IllegalArgumentException("Failed to resolve canonical path for " + file, e);
        }
    } else {
        throw new IllegalArgumentException("Name must not be empty");
    }
}
</code></pre></div></div>

<p>The class relies on the hashMap <code class="language-plaintext highlighter-rouge">mRoots</code> to keep track of what the content provider’s root directories are. In the <code class="language-plaintext highlighter-rouge">onCreate</code> method, the external storage folder is added as an authorized root directory.</p>

<p>A rouge application installed on the same device can call this content provider to browse and download files from the External Storage area, bypassing the need to add <code class="language-plaintext highlighter-rouge">EXTERNAL_STORAGE_READ</code> or <code class="language-plaintext highlighter-rouge">EXTERNAL_STORAGE_WRITE</code> to the rouge application’s manifest. As an example, F-Secure utilized its Android testing application, Drozer, to exploit this issue. The screenshot below shows that Drozer did not have any additional Android permisions (right) and it could not read the file <code class="language-plaintext highlighter-rouge">/storage/emulated/0/yay.jpg</code> (top left). Meanwhile, the ADB user could read the file <code class="language-plaintext highlighter-rouge">/storage/emulated/0/yay.jpg</code> (bottom left):</p>

<div align="center">
    <img src="/assets/cves/cve-2021-25367_1.png" />
</div>

<p>Drozer’s <code class="language-plaintext highlighter-rouge">app.provider.download</code> module can be used to dynamically craft a proper content provider call and communicate with the vulnerable content provider. The below output shows Drozer downloading the file <code class="language-plaintext highlighter-rouge">/storage/emulated/0/yay.jpg</code> from the external storage using the vulnerable content provider:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dz&gt; run app.provider.download content://com.samsung.android.app.notes.clipdatacontentprovider/external_files/yay.jpg /tmp/yay.jpg
Written 1932151 bytes

dz&gt; exit
root@324bda543ccd:/# sha1sum /tmp/yay.jpg
1e29865dc1b592b06f87cd7d569f93170daa74ed /tmp/yay.jpg
</code></pre></div></div>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released Samsung Notes version 4.2.00.22 which fixes the issue outlined in this advisory. F-Secure recommends that users upgrade Samsung Notes to at least version 4.2.00.22.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>16/12/2020</td>
      <td>Samsung confirms the vulnerability and rates it as a low risk issue</td>
    </tr>
    <tr>
      <td>12/01/2021</td>
      <td>Follow up sent to Samsung</td>
    </tr>
    <tr>
      <td>13/01/2021</td>
      <td>Samsung responded to follow up saying a patch is still being worked on</td>
    </tr>
    <tr>
      <td>09/02/2021</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>25/03/2021</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>26/03/2021</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
