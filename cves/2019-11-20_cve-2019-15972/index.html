<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cisco UCM SQLi | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Cisco UCM SQLi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A vulnerability in the web-based management interface of Cisco Unified Communications Manager could allow an authenticated, remote attacker to conduct SQL injection attacks on an affected system." />
<meta property="og:description" content="A vulnerability in the web-based management interface of Cisco Unified Communications Manager could allow an authenticated, remote attacker to conduct SQL injection attacks on an affected system." />
<link rel="canonical" href="https://maliciouserection.com/cves/2019-11-20_cve-2019-15972/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2019-11-20_cve-2019-15972/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-11-20T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cisco UCM SQLi" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-11-20T00:00:00+00:00","datePublished":"2019-11-20T00:00:00+00:00","description":"A vulnerability in the web-based management interface of Cisco Unified Communications Manager could allow an authenticated, remote attacker to conduct SQL injection attacks on an affected system.","headline":"Cisco UCM SQLi","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2019-11-20_cve-2019-15972/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2019-11-20_cve-2019-15972/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Cisco UCM SQLi</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriescisco-ucm-informix-sql-injection">Original post: <a href="https://labs.f-secure.com/advisories/cisco-ucm-informix-sql-injection/">https://labs.f-secure.com/advisories/cisco-ucm-informix-sql-injection/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Cisco Unified Call Manager (UCM) Administrator Portal version 11.5.1.14900-11, other versions may be affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Medium</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2019-15972</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>SQL Injection</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>A SQL Injection vulnerability was discovered in the Cisco Unified Call Manager (UCM) administrator portal. An authenticated user can utilize this vulnerability to enumerate the entire database that is used by Cisco UCM. This includes any secrets, such as password hashes.</p>

<p>The SQL Injection issue was found in several areas of the application. Below is a URL that was used to discover the first injection point. The GET parameter <code class="language-plaintext highlighter-rouge">whereClause</code> contained the SQL Injection payload:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://&lt;cucm_admin_portal&gt;/ccmadmin/userGroupFindList.do?searchLimVal3=&amp;searchLimVal4=&amp;whereClause=1=1 AND (select ascii(substring(tabname from 1 for 1)) FROM systables where tabid = 1) &gt; 64&amp;searchLimVal1=&amp;searchLimVal2=&amp;searchLimVal7=&amp;searchLimVal8=&amp;searchLimVal5=&amp;search LimVal6=&amp;rowsPerPageControl=/ccmadmin/userGroupFindList.do?lookup=true&amp;colCnt=4&amp;searchLimVal0=&amp;lookup=true&amp;rowsPerPage=50&amp;searchLimVal9=&amp;pageNumber=1&amp;recCnt=37&amp;multiple=true
</code></pre></div></div>

<p>The above SQL statement can be broken down into the following:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">1=1 AND</code> - establishes a true statement and forces the underlying SQL query to include the proceeding SQL statement.</li>
  <li><code class="language-plaintext highlighter-rouge">select asci(substring(tabname from 1 for 1)) FROM systables where tabid = 1</code> - In Informix SQL, all table names, called <code class="language-plaintext highlighter-rouge">tabname</code>, are kept in a table called <code class="language-plaintext highlighter-rouge">systables</code> and are assigned a unique ID value, <code class="language-plaintext highlighter-rouge">tabid</code>. This portion of the SQL statement looks for the first table name, looks at the first letter of the name and converts the value to the equivalent ASCII character value.</li>
  <li><code class="language-plaintext highlighter-rouge">&gt; 64</code> - evaluates if the ASCII character value generated from the preceding SQL statement is greater than 64.</li>
</ul>

<p>This SQL Injection was classified as a Blind Boolean injection, with server’s response size dependent on if the injected SQL statement returns a true or false response. By going through each letter, it is possible to enumerate the underlying tables, columns and entries.</p>

<h2 id="multiple-injection-points">Multiple Injection Points</h2>

<p>The above SQL Injection point was discovered and verified with the tool SQLMap, and the backend database was confirmed to be Informix. After the initial discovery, several other injection points, undetectable by SQLMap, were manually discovered.</p>

<p>After the initial disclosure to Cisco, their internal team also verified additional SQL Injection points throughout the application.</p>

<h2 id="custom-tool-exploitation">Custom Tool Exploitation</h2>

<p>As stated, SQLMap could be used to discover and verify the above Informix SQL Injection point. However, SQLMap could not be used to do the following:</p>

<ul>
  <li>Extract contents of the underlying database</li>
  <li>Discover or confirm any other SQL Injection point within the application</li>
</ul>

<p>F-Secure created some scripts that can be used to fully exploit this issue. It relies on the above SQL Injection point, but the scripts can be modified to work with any other SQL Injection point.</p>

<ul>
  <li>The scripts are available here: <a href="https://github.com/Yogehi/Cisco-UCM-SQLi-Scripts">https://github.com/Yogehi/Cisco-UCM-SQLi-Scripts</a></li>
  <li>A description on how F-Secure fully exploited this issue is available here: <a href="https://yogehi.github.io/published-research/informix-sql-injection.html">https://yogehi.github.io/published-research/informix-sql-injection.html</a></li>
</ul>

<h2 id="remediation-and-mitigation">Remediation and Mitigation</h2>

<p>At the time of this advisory’s posting, Cisco is working on releasing the following patches to the UCM application that will resolve this issue:</p>

<ul>
  <li>UCM version 11.5.2SU7</li>
  <li>UCM version 12.5.1SU2</li>
</ul>

<p>If upgrading UCM to the above versions is not possible, the following mitigations are recommended:</p>

<p>Use UCM’s LDAP login feature to manage who can login into UCM</p>

<ul>
  <li>Audit the current list of users who can login into UCM</li>
  <li>Monitor network traffic to/from the UCM application to see if this vulnerability is being exploited</li>
</ul>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>26/04/2019</td>
      <td>Issue reported to vendor</td>
    </tr>
    <tr>
      <td>07/05/2019</td>
      <td>Vendor responded, requested additional details</td>
    </tr>
    <tr>
      <td>07/05/2019</td>
      <td>Additional details sent</td>
    </tr>
    <tr>
      <td>22/05/2019</td>
      <td>Vendor responded, internal analysis still in progress</td>
    </tr>
    <tr>
      <td>11/06/2019</td>
      <td>Vendor responded, vulnerability confirmed in multiple versions of UCM</td>
    </tr>
    <tr>
      <td>14/06/2019</td>
      <td>Vendor responded, internal teams engaged to determine if other products are affected</td>
    </tr>
    <tr>
      <td>14/06/2019</td>
      <td>Informed vendor of client pre-release disclosure</td>
    </tr>
    <tr>
      <td>14/09/2019</td>
      <td>Vendor responded, approved of client pre-release disclosure</td>
    </tr>
    <tr>
      <td>25/09/2019</td>
      <td>F-Secure and vendor agree to a joint public disclosure date of 20 November</td>
    </tr>
    <tr>
      <td>20/11/2019</td>
      <td>Public disclosure</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
