<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Internet Improper Input Check | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Internet Improper Input Check" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper input check in Samsung Internet prior to version 13.2.1.46 allows attackers to launch non-exported activity in Samsung Browser via malicious deeplink." />
<meta property="og:description" content="Improper input check in Samsung Internet prior to version 13.2.1.46 allows attackers to launch non-exported activity in Samsung Browser via malicious deeplink." />
<link rel="canonical" href="https://maliciouserection.com/cves/2021-02-01_cve-2021-25354/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2021-02-01_cve-2021-25354/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Internet Improper Input Check" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-02-01T00:00:00+00:00","datePublished":"2021-02-01T00:00:00+00:00","description":"Improper input check in Samsung Internet prior to version 13.2.1.46 allows attackers to launch non-exported activity in Samsung Browser via malicious deeplink.","headline":"Samsung Internet Improper Input Check","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2021-02-01_cve-2021-25354/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2021-02-01_cve-2021-25354/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Internet Improper Input Check</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpslabsf-securecomadvisoriesopen-activities-via-samsung-browser">Original post: <a href="https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/">https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Android devices with Samsung Internet (prior to version 13.2.1.46)</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Medium</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2021-25354</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Application Security Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung S20 device for Tokyo Pwn2Own 2020. An issue was discovered that allowed a specific browsable intent in Samsung Browser (com.sec.android.app.sbrowser) to either:</p>

<ul>
  <li>Launch non-exported activities in the Samsung Browser application</li>
  <li>Launch an exported activity in any installed application</li>
</ul>

<p>Note that while this issue was found on a Samsung Galaxy device, the Samsung Internet browser application is available on the Google Play store and can be installed on any Android device with access to said store. It was confirmed that this issue could be exploited on any Android device that had the Samsung Internet application installed.</p>

<h2 id="technical-details">Technical Details</h2>

<p>The issue is due to the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser.capsule.BixbySBrowserLauncherActivity</code> methods <code class="language-plaintext highlighter-rouge">handleIntent</code> and <code class="language-plaintext highlighter-rouge">handleShareVia</code>. First, <code class="language-plaintext highlighter-rouge">handleIntent</code> does the following:</p>

<ul>
  <li>Parses the passed intent and establishes the URI <code class="language-plaintext highlighter-rouge">data</code> from the intent’s data</li>
  <li>Parses the URI <code class="language-plaintext highlighter-rouge">data</code> and establishes the list <code class="language-plaintext highlighter-rouge">pathSegments</code> from the URI’s path segments</li>
  <li>If the first item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is <code class="language-plaintext highlighter-rouge">ShareVia</code>, then the method <code class="language-plaintext highlighter-rouge">handleShareVia</code> is executed</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void handleIntent(final Intent intent) {
    final String action = intent.getAction();
    final Uri data = intent.getData();
    int n = 1;
    if ("android.intent.action.VIEW".equals(action) &amp;&amp; data != null) {
        final String string = data.toString();
        final List pathSegments = data.getPathSegments();
        if ((this.mPathSegments = (List&lt;String&gt;)pathSegments) != null) {
            if (pathSegments.size() != 0) {
                final String pathSegments2 = this.getPathSegments(0);
                if (pathSegments2 == null) {
                    return;
                }
            Label_0738: {
                switch (pathSegments2.hashCode()) {
                ...
                    case -679124017: {
                        if (pathSegments2.equals("ShareVia")) {
                            n = 4;
                            break Label_0738;
                        }
                        break;
                }
                ...
            switch (n) {
                ...
                case 4: {
                    this.handleShareVia();
                    break;
                }
</code></pre></div></div>

<p>Next, <code class="language-plaintext highlighter-rouge">handleShareVia</code> does the following:</p>

<ul>
  <li>Creates a new intent <code class="language-plaintext highlighter-rouge">createIntentWithTargetTask</code></li>
  <li>Checks if the second item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is <code class="language-plaintext highlighter-rouge">result_type_success</code></li>
  <li>Checks if the third and fouth items in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> are not null</li>
  <li>If the fourth item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is not <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity</code>, then assign the following <code class="language-plaintext highlighter-rouge">createIntetWithTargetTask</code> extra values:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">packageName</code> = the third item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code></li>
      <li><code class="language-plaintext highlighter-rouge">activityName</code> = the fourth item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code></li>
    </ul>
  </li>
  <li>Start the activity outlined in the intent <code class="language-plaintext highlighter-rouge">createIntentWithTargetTask</code></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void handleShareVia() {
    String pathSegments = getPathSegments(1);
    if (pathSegments != null) {
        Intent createIntentWithTargetTask = createIntentWithTargetTask("com.sec.android.app.sbrowser.INTENT_SHARE_VIA");
        createIntentWithTargetTask.putExtra("resultType", pathSegments);
        if ("result_type_success".equals(pathSegments)) {
            String pathSegments2 = getPathSegments(2);
            String pathSegments3 = getPathSegments(3);
            if (pathSegments2 != null &amp;&amp; pathSegments3 != null) {
                if (pathSegments3.equals("com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity") &amp;&amp; !this.isWeChatAvailable()) {
                    Log.d("BixbyLauncherActivity", "WeChat is not installed!");
                    createIntentWithTargetTask.putExtra("resultType", "result_type_fail");
                } else {
                    createIntentWithTargetTask.putExtra("packageName", pathSegments2);
                    createIntentWIthTargetTask.putExtra("activityName", pathSegments3);
                }
            } else {
                return;
            }
        ...
        try {
            getApplicationContext().startActivity(createIntentWithTargetTask);
        } catch (ActivityNotFoundException e) {
            Log.d("BixbyLauncherActivity", "[handleShareVia]" + e.toString());
        }
    }
}
</code></pre></div></div>

<p>Using this information, it is possible to create a custom intent that launches a specific activity:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/&lt;package name&gt;/&lt;activity name&gt;
</code></pre></div></div>

<p>The following example browsable intent link will launch the non-exported component <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity</code> in the Samsung Browser application:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;
</code></pre></div></div>

<p>By replacing the appropriate fields, it is also possible to launch activities that are exported in other applications. The following browsable intent link will launch the exported component <code class="language-plaintext highlighter-rouge">com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;
</code></pre></div></div>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released Samsung Browser version 13.2.1.46 which fixes the issue outlined in this advisory. F-Secure recommends that users upgrade Samsung Browser to at least version 13.2.1.46.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>12/01/2021</td>
      <td>Follow up sent to Samsung</td>
    </tr>
    <tr>
      <td>17/01/2021</td>
      <td>Samsung confirms the vulnerability and rates it as a moderate risk issue</td>
    </tr>
    <tr>
      <td>09/02/2021</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>25/03/2021</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>26/03/2021</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
